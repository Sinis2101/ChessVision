<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Chess Vision</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body>
  <div id="header"></div>
  <div id="timer"></div>
  <div id="cell"></div>
  <div id="game"></div>
  <script type="text/babel">

    ReactDOM.render(
      <h1>Chess Vision</h1>,
      document.getElementById('header')
    );

    class Timer extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          seconds: 0,
          minutes: 1,
          secFormat: '0',
          minFormat: '0'
        };
      }

      tick() {

        if (this.state.seconds == 0 && this.state.minutes > 0) {
          this.setState(state => ({
            secFormat: ''
          }));
        } else if (this.state.seconds > 10) {
          this.setState(state => ({
            secFormat: ''
          }));
        } else {
          this.setState(state => ({
            secFormat: '0'
          }));
        }

        if (this.state.minutes > 9) {
          this.setState(state => ({
            minFormat: ''
          }));
        } else {
          this.setState(state => ({
            minFormat: '0'
          }));
        }

        if (this.state.seconds == 0 && this.state.minutes > 0) {
          this.setState(state => ({
            seconds: 60,
            minutes: state.minutes - 1
          }));
        }
        if (this.state.seconds > 0) {
          this.setState(state => ({
            seconds: state.seconds - 1
          }));
        }
      }

      componentDidMount() {
        this.interval = setInterval(() => this.tick(), 1000);
      }

      componentWillUnmount() {
        clearInterval(this.interval);
      }

      render() {
        return (
          <div>
            Time: {this.state.minFormat}{this.state.minutes}:{this.state.secFormat}{this.state.seconds}
          </div>
        );
      }
    }

    ReactDOM.render(
      <Timer />,
      document.getElementById('timer')
    );


    function Square(props) {
      return (
        <button className="square" onClick={props.onClick}>
          {props.value}
        </button>
      );
    }

    class Board extends React.Component {

      constructor(props) {
        super(props);
        this.state = {
          column: 'Z',
          row: 0,
          squares: Array(64).fill(null),
        };
      }

      componentDidMount() {
        const randomRow = Math.floor(Math.random() * (9 - 1)) + 1; // Generates a random integer between 1 and 8.
        const randomColumn = Math.floor(Math.random() * (73 - 65)) + 65; // Generates a random integer ASCII code between A (65) and H (72)

        this.setState(state => ({
          column: String.fromCharCode(randomColumn), // Gets char from ASCII code
          row: randomRow
        }));
      }

      handleClick(i) {
        this.componentDidMount();
        const squares = this.state.squares.slice();
        squares[i] = 'X';
        this.setState({ squares: squares });
      }


      renderSquare(i) {
        return (
          <Square
            value={this.state.squares[i]}
            onClick={() => this.handleClick(i)}
          />
        );
      }

      render() {
        return (
          <div>
            <h3>
              {this.state.column}{this.state.row}
            </h3>

            <section>

              {this.renderSquare("a8")}
              {this.renderSquare("b8")}
              {this.renderSquare("c8")}
              {this.renderSquare("d8")}
              {this.renderSquare("e8")}
              {this.renderSquare("f8")}
              {this.renderSquare("g8")}
              {this.renderSquare("h8")}
              {this.renderSquare("a7")}
              {this.renderSquare("b7")}
              {this.renderSquare("c7")}
              {this.renderSquare("d7")}
              {this.renderSquare("e7")}
              {this.renderSquare("f7")}
              {this.renderSquare("g7")}
              {this.renderSquare("h7")}
              {this.renderSquare("a6")}
              {this.renderSquare("b6")}
              {this.renderSquare("c6")}
              {this.renderSquare("d6")}
              {this.renderSquare("e6")}
              {this.renderSquare("f6")}
              {this.renderSquare("g6")}
              {this.renderSquare("h6")}
              {this.renderSquare("a5")}
              {this.renderSquare("b5")}
              {this.renderSquare("c5")}
              {this.renderSquare("d5")}
              {this.renderSquare("e5")}
              {this.renderSquare("f5")}
              {this.renderSquare("g5")}
              {this.renderSquare("h5")}
              {this.renderSquare("a4")}
              {this.renderSquare("b4")}
              {this.renderSquare("c4")}
              {this.renderSquare("d4")}
              {this.renderSquare("e4")}
              {this.renderSquare("f4")}
              {this.renderSquare("g4")}
              {this.renderSquare("h4")}
              {this.renderSquare("a3")}
              {this.renderSquare("b3")}
              {this.renderSquare("c3")}
              {this.renderSquare("d3")}
              {this.renderSquare("e3")}
              {this.renderSquare("f3")}
              {this.renderSquare("g3")}
              {this.renderSquare("h3")}
              {this.renderSquare("a2")}
              {this.renderSquare("b2")}
              {this.renderSquare("c2")}
              {this.renderSquare("d2")}
              {this.renderSquare("e2")}
              {this.renderSquare("f2")}
              {this.renderSquare("g2")}
              {this.renderSquare("h2")}
              {this.renderSquare("a1")}
              {this.renderSquare("b1")}
              {this.renderSquare("c1")}
              {this.renderSquare("d1")}
              {this.renderSquare("e1")}
              {this.renderSquare("f1")}
              {this.renderSquare("g1")}
              {this.renderSquare("h1")}
            </section>
          </div>

        );
      }
    }

    class Game extends React.Component {
      render() {
        return (
          <div className="game">
            <div className="game-board">
              <Board />
            </div>
            <div className="game-info">
              <div>{/* status */}</div>
              <ol>{/* TODO */}</ol>
            </div>
          </div>
        );
      }
    }

    // ========================================

    ReactDOM.render(
      <Game />,
      document.getElementById('game')
    );

  </script>
</body>

</html>